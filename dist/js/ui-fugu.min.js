/*
 * angular-ui-fugu
 * Version: 0.0.1 - 2016-01-04
 * License: ISC
 */
angular.module("ui.fugu",["ui.fugu.tpls","ui.fugu.dropdown","ui.fugu.pager"]),angular.module("ui.fugu.tpls",["dropdown/templates/dropdown-choices.html","dropdown/templates/dropdown.html","pager/templates/pager.html"]),angular.module("ui.fugu.dropdown",[]).constant("fuguDropdownConfig",{colsNum:3,openClass:"open",multiColClass:"fugu-dropdown"}).service("fuguDropdownService",["$document",function(e){function t(e){if(a){var t=a.getToggleElement();e&&t&&t[0].contains(e.target)||(a.isOpen=!1,a.$apply())}}var a=null;this.open=function(n){a||e.on("click",t),a&&a!==n&&(a.isOpen=!1),a=n},this.close=function(n){a===n&&(a=null,e.off("click",t))}}]).controller("fuguDropdownCtrl",["$scope","$rootScope","$element","$attrs","$parse","$document","fuguDropdownConfig","fuguDropdownService",function(e,t,a,n,i,s,r,o){function l(){e.colsNum=r.colsNum,e.openClass=r.openClass,e.multiColClass=r.multiColClass}var u=this;e.toggleDropdown=function(t){t.preventDefault(),e.isDisabled||u.toggle()},this.toggle=function(t){var a=e.isOpen=arguments.length?!!t:!e.isOpen;return a},this.isOpen=function(){return e.isOpen},this.init=function(){l(),e.isDisabled=e.isDisabled||!!a.attr("disabled")||a.hasClass("disabled")},e.$watch("isOpen",function(t){t?o.open(e):o.close(e)}),e.getToggleElement=function(){return a.find(".dropdown-toggle")},e.count=0,this.addChild=function(){e.count++},e.$on("$locationChangeSuccess",function(){e.isOpen=!1})}]).directive("fuguDropdown",function(){return{restrict:"E",templateUrl:"templates/dropdown.html",replace:!0,require:"^fuguDropdown",transclude:!0,scope:{isOpen:"=?",isDisabled:"=?ngDisabled",btnValue:"@?"},controller:"fuguDropdownCtrl",link:function(e,t,a,n){n.init()}}}).directive("fuguDropdownChoices",function(){return{restrict:"E",templateUrl:"templates/dropdown-choices.html",require:"^fuguDropdown",replace:!0,transclude:!0,scope:!0,link:function(e,t,a,n){n.addChild()}}}),angular.module("ui.fugu.pager",[]).constant("fuguPagerConfig",{itemsPerPage:20,maxSize:5,firstText:"首页",lastText:"尾页",previousText:"上一页",nextText:"下一页"}).controller("fuguPagerCtrl",["$scope","fuguPagerConfig",function(e,t){function a(t){var a=Math.min(t-Math.floor(e.maxSize/2),e.totalPages-e.maxSize);return(0>a||isNaN(a))&&(a=0),a}function n(){e.pages=[];var t,a=Math.min(i+e.maxSize,e.totalPages);for(t=i;a>t;t++)e.pages.push({text:t,pageIndex:t,active:!1})}var i=0,s=!1;this.init=function(){e.itemsPerPage=e.itemsPerPage||t.itemsPerPage,e.maxSize=e.maxSize||t.maxSize,e.firstText=e.firstText||t.firstText,e.lastText=e.lastText||t.lastText,e.previousText=e.previousText||t.previousText,e.nextText=e.nextText||t.nextText},e.pages=[],e.currentPage=0,e.totalPages=1,e.$watch("pageNo",function(t){e.selectPage(t-1||0)}),e.$watch("totalItems",function(t){-1!==e.currentPage&&(e.totalPages=Math.ceil(t/e.itemsPerPage),(e.totalPages<=0||isNaN(e.totalPages))&&(e.totalPages=1),s&&i>e.totalPages&&(i=0,(e.currentPage<i||e.currentPage>=i+e.pages.length)&&(e.currentPage=0)),n(),s=!0,e.pages[e.currentPage-i]&&(e.pages[e.currentPage-i].active=!0),e.selectPage(e.currentPage))}),e.isFirst=function(){return e.currentPage<=0},e.isLast=function(){return e.currentPage>=e.totalPages-1},e.selectPage=function(t){if(!(t>=e.totalPages||0>t)){e.pages[e.currentPage-i]&&(e.pages[e.currentPage-i].active=!1);var s=a(t),r=e.currentPage;s!=i&&(i=s,n()),e.currentPage=t,e.pages[e.currentPage-i]&&(e.pages[e.currentPage-i].active=!0),e.$emit("pager:pageIndexChanged",e.pages[e.currentPage-i]);var o;angular.isDefined(e.pageChanged)&&r!==e.currentPage&&(o=e.pageChanged(),o&&"function"==typeof o&&o(e.currentPage+1))}},e.first=function(){e.isFirst()||this.selectPage(0)},e.last=function(){e.isLast()||this.selectPage(e.totalPages-1)},e.previous=function(){e.isFirst()||this.selectPage(e.currentPage-1)},e.next=function(){e.isLast()||this.selectPage(e.currentPage+1)}}]).directive("fuguPager",function(){return{restrict:"E",templateUrl:"templates/pager.html",replace:!0,require:"fuguPager",scope:{itemsPerPage:"=?",totalItems:"=",pageNo:"=",maxSize:"=?",firstText:"@?",lastText:"@?",previousText:"@?",nextText:"@?",pageChanged:"&?"},controller:"fuguPagerCtrl",link:function(e,t,a,n){n.init()}}}),angular.module("dropdown/templates/dropdown-choices.html",[]).run(["$templateCache",function(e){e.put("templates/dropdown-choices.html",'<li>    <a href="javascript:;" ng-transclude></a></li>')}]),angular.module("dropdown/templates/dropdown.html",[]).run(["$templateCache",function(e){e.put("templates/dropdown.html",'<div class="btn-group dropdown" ng-class="[{true:multiColClass}[count>colsNum],{true:openClass}[isOpen]]">    <button type="button" ng-click="toggleDropdown($event)" ng-disabled="isDisabled" class="btn btn-sm btn-primary dropdown-toggle">        {{btnValue}}&nbsp;<span class="caret"></span>    </button>    <ul class="dropdown-menu" ng-transclude></ul></div>')}]),angular.module("pager/templates/pager.html",[]).run(["$templateCache",function(e){e.put("templates/pager.html",'<ul class="pagination pagination-sm m-t-none m-b-none">    <li ng-class="{disabled: isFirst()}">        <a href="javascript:void(0)" ng-click="first()">{{firstText}}</a>    </li>    <li ng-class="{disabled: isFirst()}">        <a href="javascript:void(0)" ng-click="previous()">{{previousText}}</a>    </li>    <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}">        <a href="javascript:void(0)" ng-click="selectPage(page.pageIndex)">{{page.pageIndex + 1}}</a>    </li>    <li ng-class="{disabled: isLast()}">        <a href="javascript:void(0)" ng-click="next()">{{nextText}}</a>    </li>    <li ng-class="{disabled: isLast()}">        <a href="javascript:void(0)" ng-click="last()">{{lastText}}</a>    </li>    <li class="disabled">        <a href="javascript:void(0)">共{{totalPages}}页 / {{totalItems}}条</a>    </li></ul>')}]);